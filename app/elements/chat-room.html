<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
<link rel="import" href="chat-window.html">

<dom-module id="chat-room">
  <template>
    <style include="shared-styles"></style>
    <style>

    .drawerToolbar {
      color: var(--secondary-text-color);
      background-color: var(--drawer-menu-color);
      border-bottom: var(--drawer-toolbar-border-color);
    }

    paper-menu {
      --paper-menu-selected-item: {
        color: var(--primary-color);
      }
      --paper-menu-focused-item-after: {
        background: var(--primary-color);
      }
    }
    paper-menu iron-icon {
      margin-right: 33px;
      opacity: 0.54;
    }
    paper-menu a {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      text-decoration: none;
      color: var(--menu-link-color);
      font-family: 'Roboto', 'Noto', sans-serif;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      font-size: 14px;
      font-weight: 400;
      line-height: 24px;
      min-height: 48px;
      padding: 0 16px;
    }

    #login {
      position: fixed;
      right: 1em;
      top: 0;
      line-height: 64px;
      text-transform: uppercase;
      color: white;
    }
    </style>

    <paper-drawer-panel>
      <paper-header-panel drawer>
        <a id="login" href="#">Login</a>
        <paper-toolbar class="drawerToolbar">
          <span class="paper-font-title">Chats</span>
        </paper-toolbar>
        <paper-menu class="list" attr-for-selected="data-route" selected="[[route]]">
          <a data-route="home" href="/">
            <span>Home</span>
          </a>
          <a data-route="chat" href="{{baseUrl}}chat">
            <span>Chat</span>
          </a>
          <a data-route="myroom" href="{{baseUrl}}myroom">
            <span>myroom</span>
          </a>
        </paper-menu>
      </paper-header-panel>
      <div main>
        <iron-pages attr-for-selected="data-route" selected="[[chatroom]]">
          <!-- <template is="dom-repeat" items="{{chatrooms}}" as="room">
            <section data-route="{{room}}">
              <p>{{room}}</p>
              <chat-window class$="{{item}}" socket="{{setSocket()}}" chatroom="{{setItem(item)}}">
            </section>
          </template> -->
          <section data-route="home">
            <chat-window socket="{{socket}}" chatroom="home"></chat-window>
          </section>
          <section data-route="chat">
            <chat-window socket="{{socket}}" chatroom="chat"></chat-window>
          </section>
          <section data-route="myroom">
            <chat-window socket="{{socket}}" chatroom="myroom"></chat-window>
          </section>
        </iron-pages>
      </div>
    </paper-drawer-panel>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'chat-room',

    properties: {
      chatroom: {
        type: String,
        notify: true
      }
    },

    ready: function() {
      this.chatrooms = ['home', 'chat', 'myroom'];

      document.addEventListener('socket connected', function() {
        this.socket = app.socket
      }.bind(this))
    },
  })
</script>